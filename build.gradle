task build(dependsOn: ['java:bootJar', 'java:generateSchema'])

task dockerDown(type: Exec) {
    commandLine 'docker-compose', 'down'
}
task cleanDb(type: Exec, dependsOn: dockerDown) {
    commandLine 'docker-compose', 'rm', '-f', 'db'
}

task functionalTest(type: Exec, dependsOn: [cleanDb, build]) {
    environment 'NG_COMMAND', 'ng e2e --configuration docker-compose --protractor-config functional/protractor.conf.js'
    commandLine 'docker-compose', 'up', '--exit-code-from', 'frontend', '--build'
}

task runLocal(type: Exec, dependsOn: build) {
    environment 'NG_COMMAND', 'ng serve --host 0.0.0.0 --configuration local'
    commandLine 'docker-compose', 'up', '--build'
}

task check(dependsOn: functionalTest)
